!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue"),require("@xstate/vue")):"function"==typeof define&&define.amd?define(["exports","vue","@xstate/vue"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Vue={},e.Vue,e.vue$1)}(this,(function(e,n,t){"use strict";const o=Symbol();function c(){return{...n.inject(o).dialog}}function r(){const{client:e}=n.inject(o);return t.useSelector(e._service,(e=>e.context.providers))}const i=(e={})=>{const{onConnect:c=(()=>{}),onDisconnect:r=(()=>{})}=e,{client:i}=n.inject(o),l=t.useSelector(i._service,(e=>e.context.principal)),s=t.useSelector(i._service,(e=>e.context.activeProvider)),a=t.useSelector(i._service,(e=>e.value.idle)),{state:u}=t.useActor(i._service),d=n.computed((()=>u.value.matches({idle:"connected"})??!1)),v=n.computed((()=>u.value.matches({idle:"initializing"})??!1)),m=n.computed((()=>u.value.matches({idle:"connecting"})??!1)),p=n.computed((()=>u.value.matches({idle:"disconnecting"})??!1)),f=n.computed((()=>u.value.matches({idle:"idle"})??!1));let C,y;return n.onMounted((()=>{C=i.on("connect",c),y=i.on("disconnect",r)})),n.onUnmounted((()=>{C(),y()})),{principal:l,status:a,activeProvider:s,isConnected:d,isConnecting:m,isDisconnecting:p,isInitializing:v,isIdle:f,connect:e=>{i._service.send({type:"CONNECT",data:{provider:e}})},disconnect:()=>{i._service.send({type:"DISCONNECT"})}}},l=()=>{const{isConnected:e,activeProvider:t}=i(),o=n.computed((()=>!!t.value?.meta.features.includes("wallet")));return[n.computed((()=>e.value&&o.value&&t.value?t.value:void 0)),{loading:n.ref(!0),error:n.ref(!1)}]};var s=n.defineComponent({props:{dark:{type:Boolean,default:!1},style:{type:String,default:""}},emits:["onConnect","onDisconnect"],setup(e,{emit:t}){const{open:o}=c();let{isConnected:r,disconnect:l}=i({onConnect:()=>{t("onConnect",{})},onDisconnect:()=>{t("onDisconnect",{})}});return(e,t)=>(n.openBlock(),n.createElementBlock(n.Fragment,null,[n.unref(r)?(n.openBlock(),n.createElementBlock("button",{key:0,class:"connect-button",onClick:t[0]||(t[0]=()=>n.unref(l)())}," Disconnect ")):n.createCommentVNode("v-if",!0),n.unref(r)?n.createCommentVNode("v-if",!0):(n.openBlock(),n.createElementBlock("button",{key:1,class:"connect-button",onClick:t[1]||(t[1]=()=>n.unref(o)())}," Connect "))],64))}});s.__file="src/components/ConnectButton.vue";const a=["onClick"],u=["src"],d={class:"button-label"};var v=n.defineComponent({props:{dark:{type:Boolean,required:!1}},emits:["onClose","onClickInside"],setup(e,{emit:t}){const{isOpen:o,close:l,open:s}=c(),v=r(),{connect:m}=i({onConnect:()=>{l()}});n.watch(o,(e=>{e&&(document.body.style.overflow="hidden"),e||(document.body.style.overflow="unset")}));const p=()=>{l(),t("onClose")},f=e=>{e.stopPropagation(),t("onClickInside")},C=e=>{27===e.keyCode&&l()};return n.onMounted((()=>window.addEventListener("keydown",C))),n.onUnmounted((()=>window.removeEventListener("keydown",C))),(t,c)=>n.unref(o)?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass("dialog-styles "+(e.dark?" dark":" light")),onClick:p},[n.createElementVNode("div",{onClick:f,class:"dialog-container"},[n.createElementVNode("div",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(n.unref(v),(t=>(n.openBlock(),n.createElementBlock("button",{key:t.meta.id,onClick:()=>n.unref(m)(t.meta.id),class:n.normalizeClass(`button-styles ${t.meta.id}-styles`)},[n.createElementVNode("img",{class:"img-styles",src:e.dark?t.meta.icon.dark:t.meta.icon.light},null,8,u),n.createElementVNode("div",null,[n.createElementVNode("span",d,n.toDisplayString(t.meta.name),1)])],10,a)))),128))])])],2)):n.createCommentVNode("v-if",!0)}});v.__file="src/components/ConnectDialog.vue";var m=n.defineComponent({props:{client:{type:null,required:!0}},setup(e){const{client:t}=e;let c=n.ref(!1);const r={open:()=>{c.value=!0},close:()=>{c.value=!1},isOpen:c};return n.provide(o,{dialog:r,client:t}),(e,t)=>n.renderSlot(e.$slots,"default")}});m.__file="src/Connect2ICProvider.vue",e.Connect2ICProvider=m,e.ConnectButton=s,e.ConnectDialog=v,e.useBalance=()=>{const[e]=l(),t=n.ref(),o=n.ref(!0),c=n.ref(),r=async()=>{const n=e.value;if(!n)return void(c.value=void 0);const t=await(n.queryBalance?.());return c.value=t,o.value=!1,t};return n.watch(e,(e=>{r()})),[c,{loading:o,error:t,refetch:r}]},e.useCanister=(e,c={mode:"auto"})=>{const{mode:r}=c,{client:l}=n.inject(o),s=t.useSelector(l._service,(n=>n.context.anonymousActors[e])),a=t.useSelector(l._service,(n=>n.context.actors[e])),{isConnected:u}=i(),d=n.computed((()=>u.value&&a.value&&"anonymous"!==r?a.value:s.value)),v=n.computed((()=>!d.value)),m=n.ref(!1);return[d,{error:m,loading:v}]},e.useConnect=i,e.useDialog=c,e.useProviders=r,e.useTransfer=({amount:e,to:t,from:o})=>{const[c]=l();i();const r=n.ref(!0),s=n.ref();return[async()=>{const n=c.value;if(!n)return;r.value=!0;const o=await(n.requestTransfer?.({amount:e,to:t}).catch((e=>{s.value=e})));return r.value=!1,o},{loading:r,error:s}]},e.useWallet=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=connect2ic-vue.cjs.js.map
